const n=`{% block sw_login_login %} <div v-if="!showOtpForm"> {% parent %} </div> <div v-else> <form class="sw-login-login sw-login-login-otp" @submit.prevent="loginUserWithPasswordAndOtp"> <h2 class="sw-login__content-headline">{{ $tc('sw-login.index.headlineForm') }}</h2> <mt-text-field v-autofocus v-model="otp" label="One-time password" required autocomplete="one-time-code"> </mt-text-field> <div class="sw-login__submit"> <mt-button :disabled="otp.length != 6 || password.length <= 0 || username.length <= 0" class="sw-login__login-action" variant="primary"> {{ $tc('sw-login.index.buttonLogin') }} </mt-button> </div> </form> </div> {% endblock %}`,{Context:r,Application:a}=Shopware,l={template:n,data(){return{rememberOtpPassword:"",showOtpForm:!1,otp:""}},methods:{loginUserWithPasswordAndOtp(){return this.$emit("is-loading"),this.loginWithOtp(this.username,this.password,this.otp).then(()=>{this.handleLoginSuccess(),this.$emit("is-not-loading")}).catch(t=>{this.password="",this.otp="",this.showOtpForm=!1,this.handleLoginError(t),this.$emit("is-not-loading")})},loginWithOtp(t,s,i){return a.getContainer("init").httpClient.post("/oauth/token",{grant_type:"password",client_id:"administration",scopes:"write",username:t,password:s,rl_2fa_otp:i},{baseURL:r.api.apiPath}).then(e=>{const o=this.loginService.setBearerAuthentication({access:e.data.access_token,refresh:e.data.refresh_token,expiry:e.data.expires_in});return window.localStorage.setItem("redirectFromLogin","true"),o})},loginUserWithPassword(){this.rememberOtpPassword=this.password,this.$super("loginUserWithPassword")},handleLoginError(t){if(t.response.data.errors[0].detail!=="request-otp"){this.$super("handleLoginError",t);return}this.password=this.rememberOtpPassword,this.showOtpForm=!0}}};export{l as default};
//# sourceMappingURL=index-BV3ew9Eo.js.map
